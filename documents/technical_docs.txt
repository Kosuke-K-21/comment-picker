# Directory
├── README.md
├── docs/
│   └── architecture.md           # アーキテクチャ説明
│
├── infra/                        # IaC (Terraform / CloudFormation)
│   ├── terraform/
│   │   ├── modules/              # 共通モジュール (VPC, RDS, ECR, etc.)
│   │   ├── envs/
│   │   │   ├── dev/
│   │   │   ├── staging/
│   │   │   └── prod/
│   │   └── main.tf
│   └── cloudformation/
│       └── step-functions.yml    # Step Functions や Lambda 定義
│
├── frontend/                     # TypeScript + React (例)
│   ├── public/
│   │   └── index.html
│   ├── src/
│   │   ├── components/
│   │   ├── hooks/
│   │   ├── pages/
│   │   ├── services/             # API 呼び出しラッパー
│   │   ├── styles/
│   │   └── index.tsx
│   ├── package.json
│   ├── tsconfig.json
│   └── webpack.config.js
│
├── backend/                      # FastAPI + ワーカ／Lambda
│   ├── fastapi-app/              # メイン API サービス
│   │   ├── app/
│   │   │   ├── main.py
│   │   │   ├── routers/
│   │   │   ├── services/
│   │   │   ├── models/           # SQLAlchemy モデル
│   │   │   ├── schemas/          # Pydantic スキーマ
│   │   │   └── config.py
│   │   ├── Dockerfile
│   │   └── requirements.txt
│   │
│   ├── classification-worker/    # LLM 分類バッチ／非同期タスク
│   │   ├── app/
│   │   │   ├── worker.py
│   │   │   └── llm_client.py
│   │   ├── Dockerfile
│   │   └── requirements.txt
│   │
│   └── lambdas/                  # 処理トリガー用 Lambda 関数
│       ├── csv_ingest/
│       │   ├── handler.py
│       │   └── requirements.txt
│       ├── notify/
│       │   ├── handler.py
│       │   └── requirements.txt
│       └── shared/               # Lambda 共通ユーティリティ
│
├── scripts/                      # デプロイ・管理用スクリプト
│   ├── build_frontend.sh
│   ├── deploy_backend.sh
│   └── generate_presigned_url.py
│
└── .github/
    └── workflows/
        ├── ci.yml                # テスト・Lint
        └── cd.yml                # ECR→ECS、S3→CloudFront デプロイ


# Architecture
            ┌────────────┐            ┌────────────────────────┐
            │   Route53  │───────────►│    ACM (SSL/TLS)       │
            └────────────┘            └────────────────────────┘
                   │                           
                   ▼                           
            ┌────────────┐            ┌────────────────────────┐
            │ CloudFront │◄──────────►│   S3 (Static website)  │
            └────────────┘            └────────────────────────┘
                   │                           
                   ▼                           
            ┌────────────────────────────────────────────────┐
            │                Application                   │
            │                                                │
            │  ┌───────────────────┐    ┌─────────────────┐  │
            │  │ API Gateway (WX)  │───►│ ALB / Target     │  │
            │  │  (optional)       │    │ Group (ECS Fargate) │  │
            │  └───────────────────┘    └─────────────────┘  │
            │                                │              │
            │                                ▼              │
            │                     ┌─────────────────┐       │
            │                     │ECS Fargate (FastAPI)│    │
            │                     └─────────────────┘       │
            │                                │              │
            │             ┌──────────┬────────┴─────────┐    │
            │             ▼          ▼                  ▼    │
            │    ┌────────────┐ ┌──────────────┐ ┌──────────┐│
            │    │ Aurora     │ │OpenSearch    │ │ElastiCache││
            │    │ PostgreSQL │ │ (検索・分析)  │ │  (Redis)  ││
            │    └────────────┘ └──────────────┘ └──────────┘│
            └────────────────────────────────────────────────┘
                   │
                   ▼
            ┌────────────┐       CSV upload via presigned URL
            │    S3      │◄─────────────────────────────┐
            └────────────┘                              │
                   │ S3 Event (PUT)                     │
                   ▼                                    │
            ┌────────────┐                              │
            │ EventBridge│ ──► SQS Queue ────────────────┘
            └────────────┘
                   │
                   ▼
            ┌────────────────────┐
            │ Step Functions     │
            │ (ワークフロー管理) │
            └────────────────────┘
                   │
            ┌──────┼─────────────────────────────────────────┐
            ▼      ▼                                         ▼
      ┌────────┐ ┌─────────┐                             ┌───────────┐
      │ Lambda │ │ ECS Task│                             │ Lambda    │
      │ (軽処理)│ │(分類×LLM)│                             │ (通知)    │
      └────────┘ └─────────┘                             └───────────┘
           │             │                                   │
           ▼             ▼                                   ▼
      ┌────────┐   ┌────────────┐                     ┌────────────┐
      │  S3    │   │  Aurora    │◄───────────────────►│  SNS / SES  │
      │(生ログ)│   │PostgreSQL  │      通知メール／Slack│ (通知配信) │
      └────────┘   └────────────┘                     └────────────┘

# Framework
- Frontend: TypeScript
- backend: Fast API (Python)
- LLM Framework: Pydantic AI
- LLM: Google Genai SDK