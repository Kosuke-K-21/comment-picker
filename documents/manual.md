# Comment Picker アプリケーション マニュアル

## 概要

Comment Pickerは、講義アンケートの自由記述コメントを自動で分析・分類するWebアプリケーションです。大量のコメントを効率的に整理し、重要な意見を抽出して講義改善に活用できます。

## 主な機能

### 1. CSVファイルアップロード機能
- Excel（.xlsx）またはCSV（.csv）形式のファイルをアップロード
- 「必須」「任意」を含むコメント列を自動検出
- アップロード後、データの概要情報を表示

### 2. AI分析機能
- **Amazon Nova-lite LLM**を使用したコメント分析
- 以下の4つの観点で自動分類：
  - **感情分析**: ポジティブ/中立/ネガティブ
  - **カテゴリ分類**: 講義内容/講義資料/運営/その他
  - **重要度**: 高/中/低
  - **共通性**: 高/中/低
- 分析コストをリアルタイムで表示

### 3. 危険コメント検出
- ネガティブかつ重要度が高いコメントを自動検出
- 緊急対応が必要なコメントをアラート表示

### 4. 統計情報の可視化
- カテゴリ別コメント件数・割合の表示
- 感情分析結果の可視化（全体・カテゴリ別）
- 円グラフと棒グラフによる直感的な表示

### 5. トップコメント表示
- 重要度×共通性スコアによるランキング
- 全体およびカテゴリ別のトップコメント表示
- 表示件数の調整可能（1-10件）

### 6. アラート機能
- カスタム条件によるアラート設定
- 感情・カテゴリ・重要度の組み合わせ条件
- 件数または割合での閾値設定
- リアルタイムアラート通知

### 7. レポート自動生成
- **Amazon Nova-pro LLM**による包括的レポート作成
- トップ50コメントの分析
- ポジティブ意見・ネガティブ意見・総合洞察の3セクション構成

### 8. データエクスポート
- 分析結果を含むCSVファイルのダウンロード
- タイムスタンプ付きファイル名で自動保存

## 使用方法

### Step 1: ファイルアップロード
1. Webアプリケーションにアクセス
2. 「ファイルを選択」ボタンをクリック
3. Excel（.xlsx）またはCSV（.csv）ファイルを選択
4. 「アップロード」ボタンをクリック

### Step 2: データ確認
1. 「📊 データ表示」タブでアップロードされたデータを確認
2. ページネーション機能で大量データも快適に閲覧
3. 表示件数の調整可能（5/10/20/50件）

### Step 3: AI分析実行
1. 「解析開始」ボタンをクリック
2. 分析進行状況を確認
3. 完了後、解析コストが表示される
4. 危険コメントがある場合はアラート表示

### Step 4: 結果確認

#### 📈 解析結果タブ
- カテゴリ別統計情報の確認
- 感情分析結果の可視化
- 全体傾向の把握

#### 🏆 トップコメントタブ
- 重要度の高いコメントを確認
- カテゴリ別のトップコメント表示
- 優先対応すべきコメントの特定

#### 📋 レポートタブ
- 「レポート生成」ボタンでAI分析レポートを作成
- ポジティブ意見のまとめ
- ネガティブ意見のまとめ
- 総合的な洞察と改善提案

### Step 5: アラート設定（オプション）
1. 解析完了後、アラート設定セクションが表示
2. 「+ アラート追加」ボタンをクリック
3. 条件を設定：
   - アラート名
   - 感情（ポジティブ/中立/ネガティブ）
   - カテゴリ（講義内容/講義資料/運営/その他）
   - 重要度（高/中/低）
   - 閾値タイプ（件数/割合）
   - 閾値
4. 「保存」ボタンで条件を保存
5. 条件に合致する場合、自動でアラート通知

### Step 6: データエクスポート
1. 「📥 CSVダウンロード」ボタンをクリック
2. 分析結果を含むCSVファイルがダウンロード
3. 他システムでの活用や保存が可能

## 技術仕様

### フロントエンド
- **React 18** + **TypeScript**
- **Webpack** によるバンドル
- レスポンシブデザイン対応

### バックエンド
- **FastAPI** (Python)
- **pandas** によるデータ処理
- **pydantic-ai** + **Amazon Bedrock** によるLLM統合

### AI/LLM
- **Amazon Nova-lite**: コメント分析用（低コスト・高速）
- **Amazon Nova-pro**: レポート生成用（高品質・詳細分析）

### デプロイメント
- **Docker** コンテナ対応
- **docker-compose** による簡単起動
- **AWS App Runner** 対応テンプレート

## パフォーマンス

### 処理能力
- 数千件のコメントを一度に処理可能
- 並行処理による高速分析
- レート制限による安定動作

### コスト最適化
- Nova-liteによる低コスト分析
- リアルタイムコスト表示
- バッチ処理による効率化

## セキュリティ

### データ保護
- アップロードデータはメモリ内処理
- 永続化なしのセキュアな設計
- CORS設定による適切なアクセス制御

### API認証
- AWS認証情報による安全なLLMアクセス
- 環境変数による設定管理

## トラブルシューティング

### よくある問題

#### ファイルアップロードエラー
- **原因**: 対応していないファイル形式
- **解決**: Excel（.xlsx）またはCSV（.csv）ファイルを使用

#### 分析エラー
- **原因**: コメント列が見つからない
- **解決**: 列名に「必須」または「任意」を含むファイルを使用

#### 接続エラー
- **原因**: バックエンドサーバーが起動していない
- **解決**: `docker-compose up` でサーバーを起動

### エラーメッセージ対応

#### "No comment columns found"
- ファイル内に「必須」「任意」を含む列名が必要
- 列名を確認してファイルを修正

#### "Analysis failed"
- AWS認証情報を確認
- ネットワーク接続を確認
- しばらく待ってから再試行

## システム要件

### 動作環境
- **Docker** 20.10以上
- **Docker Compose** 2.0以上
- **Node.js** 18以上（開発時）
- **Python** 3.12以上（開発時）

### ブラウザ対応
- Chrome 90以上
- Firefox 88以上
- Safari 14以上
- Edge 90以上

## 起動方法

### Docker Compose使用（推奨）
```bash
# リポジトリをクローン
git clone <repository-url>
cd comment-picker

# 環境変数設定
cp backend/.env.example backend/.env
# backend/.envファイルを編集してAWS認証情報を設定

# アプリケーション起動
docker-compose up -d

# ブラウザでアクセス
# http://localhost:3000
```

### 開発環境
```bash
# バックエンド起動
cd backend
uv sync
uv run fastapi run app/main.py --port 8000

# フロントエンド起動（別ターミナル）
cd frontend
npm install
npm start
```

## ライセンス

このアプリケーションは教育目的で開発されました。商用利用については別途ご相談ください。

## サポート

技術的な問題や機能要望については、開発チームまでお問い合わせください。

---

**最終更新**: 2025年6月18日  
**バージョン**: 1.0.0
